"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9026],{9026:(L,m,a)=>{a.r(m),a.d(m,{BleListPageModule:()=>M});var g=a(6895),d=a(433),n=a(8058),u=a(2598),h=a(655),e=a(8256),_=a(2728),f=a(9620);let b=(()=>{class i{constructor(t,o,s,l,r,p,A){this.modalCtrl=t,this.database=o,this.ble=s,this.ngZone=l,this.navParams=r,this.router=p,this.navCtrl=A,this.categories=[],this.editMode=!1,this.editId=0,this.ble_device1=[],this.name="",this.mac="",this.type="",this.connectionState=!1,this.connectionStateLabel="Connected",this.buttonFill="solid",this.connectionColor="success",this.peripheral={},this.statusMessage="",this.ble_device1=r.get("ble_device"),null!=this.ble_device1.name&&(this.name=this.ble_device1.name),this.mac=this.ble_device1.id,this.setStatus("Connecting to "+this.name+this.mac)}ngOnInit(){}onWillDismiss(t){"confirm"===t.detail.role&&console.log("Confirmed Clicked")}cancel(){return this.modalCtrl.dismiss(null,"cancel")}isDisconnected(){1==this.connectionState?(console.log("ionViewWillLeave disconnecting Bluetooth"),this.ble.disconnect(this.mac).then(()=>console.log("Disconnected "+JSON.stringify(this.peripheral)),()=>console.log("ERROR disconnecting "+JSON.stringify(this.peripheral))),this.onDeviceDisconnected()):this.ble.connect(this.mac).subscribe(t=>this.onConnected(t),t=>this.onDeviceDisconnected())}onDeviceDisconnected(){this.connectionState=!1,this.buttonFill="solid",this.connectionStateLabel="Connected",this.connectionColor="success"}onConnected(t){console.log("connected",t),this.connectionState=!0,this.buttonFill="outline",this.connectionStateLabel="Disconnected",this.connectionColor="tertiary",this.ngZone.run(()=>{this.setStatus(""),this.peripheral=t})}setStatus(t){console.log(t),this.ngZone.run(()=>{this.statusMessage=t})}addCategory(){console.log(this.type),this.name.length?this.editMode?(console.log(this.name),this.database.editCategory(this.name,this.editId).then(t=>{this.name="",this.editMode=!1,this.editId=0,alert(t),this.getCategories()})):this.database.addCategory(this.name,this.ble_device1,this.type).then(t=>{alert(t),"Device Created"==t&&(this.getCategories(),this.modalCtrl.dismiss(this.ble_device1,"cancel"),this.router.navigate(["home"]))}).catch(t=>{console.log(t)}):alert("Enter category name")}getCategories(){return(0,h.mG)(this,void 0,void 0,function*(){yield this.database.getCategories().then(t=>{if(console.log(t),this.categories=[],t.rows.length>0)for(var o=0;o<t.rows.length;o++)this.categories.push(t.rows.item(o))}),console.log(this.categories)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(n.IN),e.Y36(_.V),e.Y36(f.I),e.Y36(e.R0b),e.Y36(n.X1),e.Y36(u.F0),e.Y36(n.SH))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-device-modal"]],decls:30,vars:9,consts:[["slot","start"],[3,"click"],["slot","end"],["id","connectionStateLabel"],[1,"ion-padding"],["position","floating"],["type","text","placeholder","Device Name",3,"disabled","ngModel","ngModelChange"],["interface","popover","placeholder","Select Type",3,"disabled","ngModel","ngModelChange"],["value","Wood_Lamp"],["value","Acrylic_Lamp"],["value","Trophy"],["value","Cloud"],[1,"float-container"],[1,"float-child"],["id","connectionStateBtn","expand","block","shape","round",3,"color","fill","click"],["expand","block","shape","round",3,"disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return o.cancel()}),e._uU(4,"Cancel"),e.qZA()(),e.TgZ(5,"ion-buttons",2)(6,"ion-item",3),e._uU(7),e.qZA()()()(),e.TgZ(8,"ion-content",4)(9,"ion-item")(10,"ion-label",5),e._uU(11,"Enter a name for your device modal"),e.qZA(),e.TgZ(12,"ion-input",6),e.NdJ("ngModelChange",function(l){return o.name=l}),e.qZA()(),e.TgZ(13,"ion-item")(14,"ion-select",7),e.NdJ("ngModelChange",function(l){return o.type=l}),e.TgZ(15,"ion-select-option",8),e._uU(16,"Wood Lamp"),e.qZA(),e.TgZ(17,"ion-select-option",9),e._uU(18,"Acrylic Lamp"),e.qZA(),e.TgZ(19,"ion-select-option",10),e._uU(20,"Trophy"),e.qZA(),e.TgZ(21,"ion-select-option",11),e._uU(22,"Cloud"),e.qZA()()(),e.TgZ(23,"div",12)(24,"div",13)(25,"ion-button",14),e.NdJ("click",function(){return o.isDisconnected()}),e._uU(26),e.qZA()(),e.TgZ(27,"div",13)(28,"ion-button",15),e.NdJ("click",function(){return o.addCategory()}),e._uU(29,"Add Device"),e.qZA()()()()),2&t&&(e.xp6(7),e.Oqu(o.connectionStateLabel),e.xp6(5),e.Q6J("disabled",o.connectionState)("ngModel",o.name),e.xp6(2),e.Q6J("disabled",o.connectionState)("ngModel",o.type),e.xp6(11),e.Q6J("color",o.connectionColor)("fill",o.buttonFill),e.xp6(1),e.Oqu(o.connectionStateLabel),e.xp6(2),e.Q6J("disabled",o.connectionState))},dependencies:[n.YG,n.Sm,n.W2,n.Gu,n.pK,n.Ie,n.Q$,n.t9,n.n0,n.sr,n.QI,n.j9,d.JJ,d.On]}),i})();function v(i,c){1&i&&(e.TgZ(0,"div",11)(1,"p"),e._uU(2,"Please scan the devices "),e._UZ(3,"br"),e._uU(4," Click on "),e._UZ(5,"ion-icon",12),e._uU(6," icon "),e.qZA()())}function Z(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"ion-card",13),e.NdJ("click",function(){const l=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.openModal(l))}),e.TgZ(1,"ion-card-header")(2,"ion-card-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-card-subtitle"),e._uU(5),e.qZA()(),e.TgZ(6,"ion-card-content"),e._uU(7," Disconnected "),e.qZA()()}if(2&i){const t=c.$implicit;e.xp6(3),e.AsE("",t.name," - ",t.id,""),e.xp6(2),e.Oqu(t.id)}}function C(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",14)(3,"ion-button",15),e.NdJ("click",function(){e.CHM(t),e.oxw();const s=e.MAs(8);return e.KtG(s.dismiss())}),e._uU(4,"Cancel"),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"Connect your new device"),e.qZA(),e.TgZ(7,"ion-buttons",16)(8,"ion-item",17),e._uU(9),e.qZA()()()(),e.TgZ(10,"ion-content",18)(11,"ion-item")(12,"ion-label",19),e._uU(13,"Enter a name for your device"),e.qZA(),e.TgZ(14,"ion-input",20),e.NdJ("ngModelChange",function(s){e.CHM(t);const l=e.oxw();return e.KtG(l.name=s)}),e.qZA()(),e.TgZ(15,"ion-item")(16,"ion-select",21)(17,"ion-select-option",22),e._uU(18,"Wood Lamp"),e.qZA(),e.TgZ(19,"ion-select-option",23),e._uU(20,"Acrylic Lamp"),e.qZA(),e.TgZ(21,"ion-select-option",24),e._uU(22,"Trophy"),e.qZA(),e.TgZ(23,"ion-select-option",25),e._uU(24,"Cloud"),e.qZA()()(),e.TgZ(25,"div",26)(26,"div",27)(27,"ion-button",28),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.isDisconnected())}),e._uU(28),e.qZA()(),e.TgZ(29,"div",27)(30,"ion-button",29),e._uU(31,"1 Add Device"),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(9),e.Oqu(t.connectionStateLabel),e.xp6(5),e.Q6J("disabled",t.connectionState)("ngModel",t.name),e.xp6(2),e.Q6J("disabled",t.connectionState),e.xp6(11),e.Q6J("color",t.connectionColor)("fill",t.buttonFill),e.xp6(1),e.Oqu(t.connectionStateLabel),e.xp6(2),e.Q6J("disabled",t.connectionState)}}function T(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",14)(3,"ion-button",15),e.NdJ("click",function(){e.CHM(t),e.oxw();const s=e.MAs(11);return e.KtG(s.dismiss())}),e._uU(4,"Cancel"),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"Connect your new device"),e.qZA(),e.TgZ(7,"ion-buttons",16)(8,"ion-item",17),e._uU(9),e.qZA()()()(),e.TgZ(10,"ion-content",18)(11,"ion-item")(12,"ion-label",19),e._uU(13,"Enter a name for your device"),e.qZA(),e.TgZ(14,"ion-input",20),e.NdJ("ngModelChange",function(s){e.CHM(t);const l=e.oxw();return e.KtG(l.name=s)}),e.qZA()(),e.TgZ(15,"ion-item")(16,"ion-select",21)(17,"ion-select-option",22),e._uU(18,"Wood Lamp"),e.qZA(),e.TgZ(19,"ion-select-option",23),e._uU(20,"Acrylic Lamp"),e.qZA(),e.TgZ(21,"ion-select-option",24),e._uU(22,"Trophy"),e.qZA(),e.TgZ(23,"ion-select-option",25),e._uU(24,"Cloud"),e.qZA()()(),e.TgZ(25,"div",26)(26,"div",27)(27,"ion-button",28),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.isDisconnected())}),e._uU(28),e.qZA()(),e.TgZ(29,"div",27)(30,"ion-button",29),e._uU(31,"Add Device"),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(9),e.Oqu(t.connectionStateLabel),e.xp6(5),e.Q6J("disabled",t.connectionState)("ngModel",t.name),e.xp6(2),e.Q6J("disabled",t.connectionState),e.xp6(11),e.Q6J("color",t.connectionColor)("fill",t.buttonFill),e.xp6(1),e.Oqu(t.connectionStateLabel),e.xp6(2),e.Q6J("disabled",t.connectionState)}}const S=[{path:"",component:(()=>{class i{constructor(t,o,s,l,r,p){this.router=t,this.toastCtrl=o,this.ble=s,this.ngZone=l,this.modalCtrl=r,this.database=p,this.categoryName="",this.categories=[],this.editMode=!1,this.editId=0,this.name="",this.connectionState=!0,this.isScanning=!1,this.buttonFill="outline",this.connectionStateLabel="Disconnected",this.connectionColor="tertiary",this.scanIcon="search-outline",this.scanColor="primary",this.devices=[],this.statusMessage=""}onWillDismiss(t){"confirm"===t.detail.role&&console.log("Confirmed Clicked")}isDisconnected(){1==this.connectionState?(this.connectionState=!1,this.buttonFill="solid",this.connectionStateLabel="Connected",this.connectionColor="success"):(this.connectionState=!0,this.buttonFill="outline",this.connectionStateLabel="Disconnected",this.connectionColor="tertiary")}bleScan(){this.scanIcon="stop-outline",this.scanColor="danger"}stopScan(){this.isScanning=!1,console.log("stop scan"),this.scanIcon="search-outline",this.scanColor="primary"}openModal(t){return(0,h.mG)(this,void 0,void 0,function*(){console.log(t),(yield this.modalCtrl.create({component:b,componentProps:{ble_device:t}})).present()})}scan(){this.bleScan(),this.isScanning?this.stopScan():(this.isScanning=!0,this.setStatus("Scanning for Bluetooth LE Devices"),this.devices=[],this.ble.scan([],5).subscribe(t=>this.onDeviceDiscovered(t),t=>this.scanError(t)),setTimeout(this.setStatus.bind(this),5e3,"Scan complete"))}onDeviceDiscovered(t){console.log("Discovered "+JSON.stringify(t,null,2)),this.ngZone.run(()=>{this.devices.push(t)})}scanError(t){return(0,h.mG)(this,void 0,void 0,function*(){this.stopScan(),this.setStatus("Error "+t),(yield this.toastCtrl.create({message:"Error scanning for Bluetooth low energy devices",position:"bottom",duration:5e3})).present()})}setStatus(t){console.log(t,"setsatus"),this.ngZone.run(()=>{this.statusMessage=t}),setTimeout(this.stopScan.bind(this),1e4,"Scan Stopped")}ionViewDidEnter(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.F0),e.Y36(n.yF),e.Y36(f.I),e.Y36(e.R0b),e.Y36(n.IN),e.Y36(_.V))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-ble-list"]],decls:16,vars:6,consts:[[3,"translucent"],["id","ble-list",3,"fullscreen"],["style","text-align:center;margin: 10px; height: 80vh;display: flex;justify-content: center;align-items: center;",4,"ngIf"],["id","open-custom-dialog-connected",3,"click",4,"ngFor","ngForOf"],["trigger","open-modal1"],["modal",""],["trigger","open-custom-dialog-connected"],["modall",""],["slot","fixed","vertical","bottom","horizontal","end",3,"click"],[3,"color"],[3,"name"],[2,"text-align","center","margin","10px","height","80vh","display","flex","justify-content","center","align-items","center"],["name","search-outline"],["id","open-custom-dialog-connected",3,"click"],["slot","start"],[3,"click"],["slot","end"],["id","connectionStateLabel"],[1,"ion-padding"],["position","floating"],["type","text","placeholder","Device Name",3,"disabled","ngModel","ngModelChange"],["interface","popover","placeholder","Select Type",3,"disabled"],["value","Wood_Lamp"],["value","Acrylic_Lamp"],["value","Trophy"],["value","Cloud"],[1,"float-container"],[1,"float-child"],["id","connectionStateBtn","expand","block","shape","round",3,"color","fill","click"],["expand","block","shape","round",3,"disabled"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3," Lets find your device "),e.qZA()()(),e.TgZ(4,"ion-content",1),e.YNc(5,v,7,0,"div",2),e.YNc(6,Z,8,3,"ion-card",3),e.TgZ(7,"ion-modal",4,5),e.YNc(9,C,32,8,"ng-template"),e.qZA(),e.TgZ(10,"ion-modal",6,7),e.YNc(12,T,32,8,"ng-template"),e.qZA(),e.TgZ(13,"ion-fab",8),e.NdJ("click",function(){return o.scan()}),e.TgZ(14,"ion-fab-button",9),e._UZ(15,"ion-icon",10),e.qZA()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("ngIf",0==o.devices.length),e.xp6(1),e.Q6J("ngForOf",o.devices),e.xp6(8),e.Q6J("color",o.scanColor),e.xp6(1),e.Q6J("name",o.scanIcon))},dependencies:[g.sg,g.O5,d.JJ,d.On,n.YG,n.Sm,n.PM,n.FN,n.Zi,n.tO,n.Dq,n.W2,n.IJ,n.W4,n.Gu,n.gu,n.pK,n.Ie,n.Q$,n.t9,n.n0,n.wd,n.sr,n.ki,n.QI,n.j9],styles:["ion-card-header.ios[_ngcontent-%COMP%]{display:flex;flex-flow:column-reverse}.float-container[_ngcontent-%COMP%]{padding:20px}.float-child[_ngcontent-%COMP%]{width:50%;float:left;padding:20px}"]}),i})()}];let y=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.Bz.forChild(S),u.Bz]}),i})(),M=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.ez,d.u5,n.Pc,y]}),i})()}}]);