"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9026],{9026:(D,m,c)=>{c.r(m),c.d(m,{BleListPageModule:()=>Z});var h=c(6895),u=c(433),i=c(8058),d=c(2598),g=c(655),e=c(8256),f=c(2728),v=c(9620);let b=(()=>{class o{constructor(t,n,l,a,r,p,M){this.modalCtrl=t,this.database=n,this.ble=l,this.ngZone=a,this.navParams=r,this.router=p,this.navCtrl=M,this.categories=[],this.editMode=!1,this.editId=0,this.ble_device1=[],this.name="",this.uname="",this.mac="",this.type="",this.connectionState=!1,this.connectionStateLabel="Connected",this.buttonFill="solid",this.connectionColor="success",this.peripheral={},this.statusMessage="",this.ble_device1=r.get("ble_device"),null!=this.ble_device1.name&&(this.name=this.uname=this.ble_device1.name),this.mac=this.ble_device1.id,this.setStatus("Connecting to "+this.name+this.mac)}ngOnInit(){}onWillDismiss(t){"confirm"===t.detail.role&&console.log("Confirmed Clicked")}cancel(){return this.modalCtrl.dismiss(null,"cancel")}isDisconnected(){1==this.connectionState?(console.log("ionViewWillLeave disconnecting Bluetooth"),this.ble.disconnect(this.mac).then(()=>console.log("Disconnected "+JSON.stringify(this.peripheral)),()=>console.log("ERROR disconnecting "+JSON.stringify(this.peripheral))),this.onDeviceDisconnected()):this.ble.connect(this.mac).subscribe(t=>this.onConnected(t),t=>this.onDeviceDisconnected())}onDeviceDisconnected(){this.connectionState=!1,this.buttonFill="solid",this.connectionStateLabel="Connected",this.connectionColor="success"}onConnected(t){console.log("connected",t),this.connectionState=!0,this.buttonFill="outline",this.connectionStateLabel="Disconnected",this.connectionColor="tertiary",this.ngZone.run(()=>{this.setStatus(""),this.peripheral=t})}setStatus(t){console.log(t),this.ngZone.run(()=>{this.statusMessage=t})}addCategory(){console.log(this.type),this.uname.length?this.editMode?(console.log(this.name),this.database.editCategory(this.name,this.editId).then(t=>{this.name="",this.editMode=!1,this.editId=0,alert(t),this.getCategories()})):this.database.addCategory(this.name,this.uname,this.ble_device1,this.type).then(t=>{alert(t),"Device Created"==t&&(this.getCategories(),this.modalCtrl.dismiss(this.ble_device1,"cancel"),this.router.navigate(["home"]))}).catch(t=>{console.log(t)}):alert("Enter Device name")}getCategories(){return(0,g.mG)(this,void 0,void 0,function*(){yield this.database.getCategories().then(t=>{if(console.log(t),this.categories=[],t.rows.length>0)for(var n=0;n<t.rows.length;n++)this.categories.push(t.rows.item(n))}),console.log(this.categories)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(i.IN),e.Y36(f.V),e.Y36(v.I),e.Y36(e.R0b),e.Y36(i.X1),e.Y36(d.F0),e.Y36(i.SH))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-device-modal"]],decls:30,vars:9,consts:[["slot","start"],[3,"click"],["slot","end"],["id","connectionStateLabel"],[1,"ion-padding"],["position","floating"],["type","text","placeholder","Device Name",3,"disabled","ngModel","ngModelChange"],["interface","popover","placeholder","Select Type",3,"disabled","ngModel","ngModelChange"],["value","Wood_Lamp"],["value","Acrylic_Lamp"],["value","Trophy"],["value","Cloud"],[1,"float-container"],[1,"float-child"],["id","connectionStateBtn","expand","block","shape","round",3,"color","fill","click"],["expand","block","shape","round",3,"disabled","click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return n.cancel()}),e._uU(4,"Cancel"),e.qZA()(),e.TgZ(5,"ion-buttons",2)(6,"ion-item",3),e._uU(7),e.qZA()()()(),e.TgZ(8,"ion-content",4)(9,"ion-item")(10,"ion-label",5),e._uU(11,"Enter a name for your device modal"),e.qZA(),e.TgZ(12,"ion-input",6),e.NdJ("ngModelChange",function(a){return n.uname=a}),e.qZA()(),e.TgZ(13,"ion-item")(14,"ion-select",7),e.NdJ("ngModelChange",function(a){return n.type=a}),e.TgZ(15,"ion-select-option",8),e._uU(16,"Wood Lamp"),e.qZA(),e.TgZ(17,"ion-select-option",9),e._uU(18,"Acrylic Lamp"),e.qZA(),e.TgZ(19,"ion-select-option",10),e._uU(20,"Trophy"),e.qZA(),e.TgZ(21,"ion-select-option",11),e._uU(22,"Cloud"),e.qZA()()(),e.TgZ(23,"div",12)(24,"div",13)(25,"ion-button",14),e.NdJ("click",function(){return n.isDisconnected()}),e._uU(26),e.qZA()(),e.TgZ(27,"div",13)(28,"ion-button",15),e.NdJ("click",function(){return n.addCategory()}),e._uU(29,"Add Device"),e.qZA()()()()),2&t&&(e.xp6(7),e.Oqu(n.connectionStateLabel),e.xp6(5),e.Q6J("disabled",n.connectionState)("ngModel",n.uname),e.xp6(2),e.Q6J("disabled",n.connectionState)("ngModel",n.type),e.xp6(11),e.Q6J("color",n.connectionColor)("fill",n.buttonFill),e.xp6(1),e.Oqu(n.connectionStateLabel),e.xp6(2),e.Q6J("disabled",n.connectionState))},dependencies:[i.YG,i.Sm,i.W2,i.Gu,i.pK,i.Ie,i.Q$,i.t9,i.n0,i.sr,i.QI,i.j9,u.JJ,u.On]}),o})();function C(o,s){1&o&&(e.TgZ(0,"div",7)(1,"p"),e._uU(2,"Please scan the devices "),e._UZ(3,"br"),e._uU(4," Click on "),e._UZ(5,"ion-icon",8),e._uU(6," icon "),e.qZA()())}function _(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-card",9),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.openModal(a))}),e.TgZ(1,"ion-card-header")(2,"ion-card-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-card-subtitle"),e._uU(5),e.qZA()(),e.TgZ(6,"ion-card-content"),e._uU(7," Disconnected "),e.qZA()()}if(2&o){const t=s.$implicit;e.xp6(3),e.AsE("",t.uname," - ",t.id,""),e.xp6(2),e.Oqu(t.id)}}const S=[{path:"",component:(()=>{class o{constructor(t,n,l,a,r,p){this.router=t,this.toastCtrl=n,this.ble=l,this.ngZone=a,this.modalCtrl=r,this.database=p,this.categoryName="",this.categories=[],this.editMode=!1,this.editId=0,this.name="",this.connectionState=!0,this.isScanning=!1,this.buttonFill="outline",this.connectionStateLabel="Disconnected",this.connectionColor="tertiary",this.scanIcon="search-outline",this.scanColor="primary",this.devices=[],this.statusMessage=""}onWillDismiss(t){"confirm"===t.detail.role&&console.log("Confirmed Clicked")}isDisconnected(){1==this.connectionState?(this.connectionState=!1,this.buttonFill="solid",this.connectionStateLabel="Connected",this.connectionColor="success"):(this.connectionState=!0,this.buttonFill="outline",this.connectionStateLabel="Disconnected",this.connectionColor="tertiary")}bleScan(){this.scanIcon="stop-outline",this.scanColor="danger"}stopScan(){this.isScanning=!1,console.log("stop scan"),this.scanIcon="search-outline",this.scanColor="primary"}openModal(t){return(0,g.mG)(this,void 0,void 0,function*(){console.log(t),(yield this.modalCtrl.create({component:b,componentProps:{ble_device:t}})).present()})}scan(){this.bleScan(),this.isScanning?this.stopScan():(this.isScanning=!0,this.setStatus("Scanning for Bluetooth LE Devices"),this.devices=[],this.ble.scan([],5).subscribe(t=>this.onDeviceDiscovered(t),t=>this.scanError(t)),setTimeout(this.setStatus.bind(this),5e3,"Scan complete"))}onDeviceDiscovered(t){console.log("Discovered "+JSON.stringify(t,null,2)),this.ngZone.run(()=>{this.devices.push(t)})}scanError(t){return(0,g.mG)(this,void 0,void 0,function*(){this.stopScan(),this.setStatus("Error "+t),(yield this.toastCtrl.create({message:"Error scanning for Bluetooth low energy devices",position:"bottom",duration:5e3})).present()})}setStatus(t){console.log(t,"setsatus"),this.ngZone.run(()=>{this.statusMessage=t}),setTimeout(this.stopScan.bind(this),1e4,"Scan Stopped")}ionViewDidEnter(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.F0),e.Y36(i.yF),e.Y36(v.I),e.Y36(e.R0b),e.Y36(i.IN),e.Y36(f.V))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-ble-list"]],decls:10,vars:6,consts:[[3,"translucent"],["id","ble-list",3,"fullscreen"],["style","text-align:center;margin: 10px; height: 80vh;display: flex;justify-content: center;align-items: center;",4,"ngIf"],["id","open-custom-dialog-connected",3,"click",4,"ngFor","ngForOf"],["slot","fixed","vertical","bottom","horizontal","end",3,"click"],[3,"color"],[3,"name"],[2,"text-align","center","margin","10px","height","80vh","display","flex","justify-content","center","align-items","center"],["name","search-outline"],["id","open-custom-dialog-connected",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3," Lets find your device "),e.qZA()()(),e.TgZ(4,"ion-content",1),e.YNc(5,C,7,0,"div",2),e.YNc(6,_,8,3,"ion-card",3),e.TgZ(7,"ion-fab",4),e.NdJ("click",function(){return n.scan()}),e.TgZ(8,"ion-fab-button",5),e._UZ(9,"ion-icon",6),e.qZA()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("ngIf",0==n.devices.length),e.xp6(1),e.Q6J("ngForOf",n.devices),e.xp6(2),e.Q6J("color",n.scanColor),e.xp6(1),e.Q6J("name",n.scanIcon))},dependencies:[h.sg,h.O5,i.PM,i.FN,i.Zi,i.tO,i.Dq,i.W2,i.IJ,i.W4,i.Gu,i.gu,i.wd,i.sr],styles:["ion-card-header.ios[_ngcontent-%COMP%]{display:flex;flex-flow:column-reverse}.float-container[_ngcontent-%COMP%]{padding:20px}.float-child[_ngcontent-%COMP%]{width:50%;float:left;padding:20px}"]}),o})()}];let y=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[d.Bz.forChild(S),d.Bz]}),o})(),Z=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[h.ez,u.u5,i.Pc,y]}),o})()}}]);